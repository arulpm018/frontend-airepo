
## API Usage

### Send Chat Message

```bash
curl -X POST http://localhost:8000/api/v1/chat/send \
  -H "Content-Type: application/json" \
  -H "X-User-ID: 12345678-1234-1234-1234-123456789012" \
  -d '{
    "query": "Cari penelitian tentang machine learning tahun 2023"
  }'
```

### Get User Sessions

```bash
curl http://localhost:8000/api/v1/sessions \
  -H "X-User-ID: 12345678-1234-1234-1234-123456789012"
```

### Get Session Details

```bash
curl http://localhost:8000/api/v1/sessions/{session_id} \
  -H "X-User-ID: 12345678-1234-1234-1234-123456789012"
```


### Frontend Developer Guide

#### 1. Start New Chat & Simple Query
- **Payload**: Set `session_id` to `null`.
- **Logic**: System creates new session, generates title, and returns new `session_id`.

```json
POST /api/v1/chat/send
{
  "query": "Halo, saya mau nanya tentang padi",
  "session_id": null
}
```

#### 2. Continue Conversation
- **Payload**: Use `session_id` from previous response.
- **Logic**: System appends message to history.

```json
POST /api/v1/chat/send
{
  "query": "Bagaimana cara tanamnya?",
  "session_id": 88
}
```

#### 3. Ask Follow-up on Specific Papers (Checklist)
- **Payload**: Include `selected_paper_ids`.
- **Logic**: **SKIPS** standard retrieval. AI uses *only* the checked papers as context.
- **Use Case**: User clicks "Checklist" on specific references to ask details about them.

```json
POST /api/v1/chat/send
{
  "query": "Jelaskan metode di paper ini lebih detail",
  "session_id": 88,
  "selected_paper_ids": [
    "550e8400-e29b-41d4-a716-446655440000",
    "660e8400-e29b-41d4-a716-446655440000"
  ]
}
```

#### 4. Handling "New Chat" Button
- When user clicks "New Chat":
    1.  Clear local chat UI.
    2.  Set local variable `currentSessionId = null`.
    3.  **Do not** call API immediately.
    4.  Wait for user to send first message (See Point 1).


###structure response

{
  "session_id": 49,
  "message_id": 83,
  "references": [
    {
      "rank": 1,
      "paper_id": "a8dc81e1-f6d3-49b8-b961-b6ddc412ab1c",
      "title": "Determinasi dan Identifikasi Cendawan Terbawa Benih Padi",
      "authors": "Rahmadi, Rizky",
      "year": 2021,
      "faculty": "Faculty of Agriculture",
      "department": "Plant Protection",
      "type": "Skripsi",
      "abstract": "Rice is an important food crop in Indonesia that cannot be separated from\r\npests and plant diseases. Several seed-borne pathogens can cause abnormal\r\ngermination, seed mortality, and become a source of inoculum that can cause\r\ndisease epidemics in the field. Considering the importance of this impact, this study\r\naimed to detect the seedborne fungi carried by rice seeds using a modified blotter\r\ntest method with two treatments (disinfectant and control) and 4 replications. This\r\nresearch was conducted using Baroma rice seeds and IR Nutri Zinc rice seeds from\r\nMuara Experimental Garden, Indonesia Center for Rice Research, Bogor, West\r\nJava. Data were analyzed of variance with Tukey test with α = 5%. The results\r\nshowed that the germination of IR Nutri Zinc variety was higher than BAROMA\r\nvariety. Surface sterilization treatment with 1% NaOCl was able to eliminate seed\r\ncontaminants as indicated by a lower percentage of infection. The fungi detected as\r\ncontaminants were Aspergillus spp. The dominance of Aspergillus causes other\r\nmain fungi that can't be detected in rice seeds.",
      "keywords": "Aspergillus, blotter test, epidemi, kontaminasi",
      "url": "https://repository.ipb.ac.id/handle/123456789/107057",
      "relevance_score": 0.650670015652176
    },
    {
      "rank": 2,
      "paper_id": "298a2e57-bfd6-415d-99ba-6455e38992a7",
      "title": "Tingkat Kemasakan Benih Padi Varietas IPB 3S dan Hubungannya dengan Pematahan Dormansi",
      "authors": "Putri, Astari Abyan",
      "year": 2022,
      "faculty": "Faculty of Agriculture",
      "department": "Agronomy and Horticulture",
      "type": "Skripsi",
      "abstract": "Waktu panen benih padi yang tepat dapat memaksimalkan hasil dan mutu\r\nbenih. Benih masak fisiologis ditandai dengan bobot kering dan vigor benih\r\nmaksimum. Penelitian bertujuan menentukan masak fisiologis benih padi varietas\r\nIPB 3S, serta mendapatkan metode pematahan dormansi yang tepat. Penentuan\r\nmasak fisiologis menggunakan rancangan acak lengkap satu faktor, yaitu tingkat\r\nmasak (kuning ½ malai, kuning ¾ malai, kuning seluruh malai, malai kuning kering,\r\ndan lewat waktu panen). Satuan panas tanaman diperoleh dari pengukuran suhu\r\nharian mulai tanam hingga panen. Pematahan dormansi benih menggunakan\r\nrancangan acak lengkap tersarang dua faktor, faktor pertama yaitu periode afterripening (0, 1, dan 2 minggu setelah simpan atau MSP) dan faktor kedua yaitu\r\nperendaman KNO3 (KNO3 0,2% dan kontrol). Perendaman benih dengan KNO3\r\ntersarang dalam periode after-ripening. Masak fisiologis benih tercapai pada\r\ntingkat masak malai kuning kering 34 hari setelah antesis dengan ciri seluruh bulir\r\npada malai berwarna kuning kering serta daun bendera dan daun dalam satu rumpun\r\ntelah mengering, dengan bobot kering benih 3,788 g dan kadar air 16,4%. Satuan\r\npanas yang dibutuhkan hingga mencapai masak fisiologis sebesar 2204,4 0\r\nCd.\r\nBenih padi varietas IPB 3S yang telah dikeringkan (kadar air 8–10%) belum patah\r\ndormansinya hingga periode penyimpanan after-ripening 2 MSP pada suhu 18–20\r\n0\r\nC. Teknik pematahan dormansi dengan merendam benih dalam larutan KNO3\r\n0,2% selama 36 jam pada suhu 28–30 0\r\nC mampu mematahkan dormansi benih\r\nsebelum disimpan (0 MSP) dengan daya berkecambah 94,3%, dan seiring dengan\r\nmeningkatnya periode after-ripening (1 MSP dan 2 MSP) viabilitas dan vigor benih\r\nsemakin meningkat.",
      "keywords": "heat unit, KNO3, seed dry weight, seed vigor, after-ripening",
      "url": "https://repository.ipb.ac.id/handle/123456789/113330",
      "relevance_score": 0.6293152262412962
    },
    {
      "rank": 3,
      "paper_id": "32fd5803-a23c-4833-86a9-3619735b9854",
      "title": "Analisis Kemerosotan Mutu Benih Pada Tiga Varietas Padi (Oriza satia L)",
      "authors": "Hakim, Noor",
      "year": 1983,
      "faculty": "Faculty of Mathematics and Natural Sciences",
      "department": "Statistics and Data Sciences",
      "type": "Skripsi",
      "abstract": "Tujuan penelitian ini ialah menguji sampai seberapa jauh penurunan hasil bila benih suatu varietas padi dita- nam terus menerus tanpa ada usaha untuk mempertahankan kemurnian varietas dan perbaikan mutu benih. Benih yang di- gunakan adalah lima tingkat mutu benih sebar, berasal dari varietas Pelita I-1, PB-26,, dan PB-36. Penelitian dilaku- kan dengan menggunakan Rancangan Petak Terbagi.\r\nKemerosotan atau penurunan produksi tidak terjadi sampai dengan benih sebar turunan ke empat, akan tetapi rata-rata produksi sangat dipengaruhi varietas yang ditanam. Campuran varietas lain akan semakin banyak dijumpai, bila tidak ada usaha untuk memperbaiki kemurnian dan mutu benih. Sedangkan persentase gabah hampa dan persentase kotoran benih tidak dipengaruhi oleh tingkat mutu benih sebar.",
      "keywords": null,
      "url": "https://repository.ipb.ac.id/handle/123456789/150714",
      "relevance_score": 0.6110501753032042
    },
    {
      "rank": 4,
      "paper_id": "3bee288b-f092-4a79-8e3c-1d17e7e6bc64",
      "title": "Karakter Fisiologi dan Hasil Varietas Padi Tipe Baru IPB",
      "authors": "Raudho, Zahrotur",
      "year": 2025,
      "faculty": "Agriculture",
      "department": null,
      "type": "Tesis",
      "abstract": "IPB University telah mengembangkan varietas Padi Tipe Baru yang dikenal dengan “PTB IPB”. Penelitian ini mempelajari keragaan morfofisiologi dan hasil beberapa varietas padi IPB yang baru dikembangkan, yaitu IPB 12S, IPB 13S, IPB 14S, IPB 15S, IPB 9G, dan IPB 3S, dibandingkan dengan varietas unggul nasional yaitu Inpari 30 dan Inpari 32 yang banyak dibudidayakan secara luas. Penelitian ini dilaksanakan di Kebun Percobaan Sawah Baru, Babakan, Dramaga, IPB University. Penelitian menggunakan Rancangan Acak Kelompok Lengkap (RAKL) satu faktor yaitu varietas, terdiri dari delapan petak percobaan dan tiga ulangan sehingga terdapat 24 satuan petak percobaan. Hasil penelitian menunjukkan bahwa varietas “PTB IPB” menunjukkan keunggulan morfologis, seperti tinggi tanaman yang lebih tinggi, luas daun bendera yang lebih besar, dan jumlah butir per malai yang lebih banyak dibandingkan varietas unggul nasional Inpari 30 dan Inpari 32. Namun, keunggulan morfologi ini belum sepenuhnya disertai dengan peningkatan kinerja fisiologis yang mendukung, termasuk laju fotosintesis, laju tumbuh relatif, akumulasi karbohidrat non-struktural (NSC), dan indeks panen. Ketidakseimbangan antara kapasitas sumber (source) dan kekuatan sink menghasilkan efisiensi pengisian biji yang rendah, seperti yang diamati pada varietas padi IPB 9G dan IPB 15S, yang mencakup ukuran sink yang besar tetapi persentase gabah bernas rendah. Analisis korelasi menunjukkan karakter luas daun bendera, panjang batang, panjang malai, kandungan pati fase panen, biomassa tajuk awal serta fotosintesis dan akumulasi NSC pada fase heading+18 berkorelasi positif yang nyata dengan jumlah gabah bernas per malai. Hal ini menegaskan karakter tersebut merupakan indikator penting dalam mendukung kapasitas sink dan hasil varietas padi. Faktor lingkungan seperti intensitas cahaya rendah, curah hujan tinggi, dan kelembaban tinggi telah membatasi ekspresi fisiologis. Oleh karena itu, diperlukan strategi budidaya adaptif dan kondisi pertumbuhan yang sesuai untuk mendukung keunggulan genetik varietas “PTB IPB” yang optimal di agroekosistem sawah yang sesuai.",
      "keywords": "laju tumbuh relatif, non-structural carbohydrates ( NSC), produktivitas tinggi, efisiensi fisiologi, laju fotosintesis",
      "url": "https://repository.ipb.ac.id/handle/123456789/170123",
      "relevance_score": 0.6090817554446907
    },
    {
      "rank": 5,
      "paper_id": "62a68691-4ddc-400c-9cc9-ccaba63ff82c",
      "title": "Identifikasi dan Evaluasi Kemurnian Genetik Benih Padi Hibrida Menggunakan Marka Mikrosatelit",
      "authors": "Mulsanti, Indria Wahyu",
      "year": 2011,
      "faculty": "Agriculture",
      "department": null,
      "type": "Tesis",
      "abstract": "Benih dikatakan mempunyai mutu genetik yang baik apabila benih tersebut asli (true to type), sesuai dengan varietas yang dimaksud. Uji kemurnian benih merupakan tahapan yang harus dilakukan untuk mengendalikan mutu genetik dari suatu lot benih. Kemurnian genetik benih F1 merupakan hal yang sangat penting pada produksi benih padi hibrida. Adanya campuran pada benih padi hibrida dapat menyebabkan penurunan produksi dan buruknya pertanaman di lapang.  \r\nDi Indonesia, uji kemurnian benih menggunakan SSR belum banyak dilakukan pada padi khususnya padi hibrida. Marka SSR akan sangat bermanfat untuk mengetahui  apakah benih padi hibrida betul hasil persilangan antar dua galur tetua pembentuknya. Oleh karena itu identifikasi marka-marka polimorfis dari galur-galur tetua perlu dilakukan \r\nPenelitian ini bertujuan untuk: 1) Mendapatkan marka SSR spesifik yang dapat digunakan untuk mengidentifikasi galur tetua beberapa varietas padi hibrida, serta melihat tingkat polimorfisme dari marka tersebut; 2) Mempelajari sterilitas malai beberapa galur mandul jantan; 3)  Membandingkan uji kemurnian benih dengan SSR dan grow out test; 4) Mendapatkan karakter kualitatif dan kuantitatif dari dua varietas padi hibrida (Hipa 6 dan Hipa 7) untuk melengkapi deskripsi varietas. \r\nPenelitian dibagi menjadi dua kegiatan utama, yang pertama adalah identifikasi marka molekuler polimorfis dan yang kedua adalah uji kemurnia benih hibrida dan karakterisasi morfologi tanaman. Selain itu untuk mengetahui persentase tingkat sterilitas galur mandul jantan yang digunakan, maka dilakukan uji sterilitas galur mandul jantan. Galur tetua dari lima varietas hibrida (Hipa 6, Hipa 7, Hipa 8, Hipa 9 dan Hipa 10) digunakan untuk identifikasi marka SSR, sedangkan untuk uji kemurnian benih digunakan dua varietas hibrida yaitu Hipa 6 dan Hipa 7. Identifikasi marka molekuler polimorfis menggunakan 16 marka SSR yang dipilih dari linkage map (http://www.gramene.org).  \r\nPenanaman F1 hibrida di lapang dirancang sesuai dengan panduan pengujian individual (PPI) kebaruan, keunikan, keseragaman dan kestabilan tanaman padi. Empat puluh individu tanaman ditentukan secara acak sebagai tanaman contoh untuk masing-masing hibrida (Hipa 6 dan Hipa 7). Setiap individu tanaman contoh tersebut diambil sampel daunnya untuk dilakukan uji kemurnian genetik secara molekuler. Pengamatan morfologi untuk pengujian kemurnian benih di lapang juga dilakukan pada tanaman contoh yang sama.  \r\nPenentuan tingkat kemurnian di lapang dilakukan berdasarkan karakter morfologi dari setiap individu tanaman pada berbagai tahap pertumbuhan tanaman. Pengamatan meliputi : 1) kemurnian  (campuran varietas lain),    2) karakter kualitatif, 3) karakter kuantitatif tanaman. Pengamatan karakter tanaman dilakukan untuk mengindentifikasi adanya varietas campuran dan melengkapi deskripsi varietas yang sudah ada.  Uji sterilitas galur mandul jantan menggunakan IR62829A, IR58025A, dan IR68897A.\r\nBerdasarkan hasil penelitian diperoleh tujuh marka SSR polimorfis dari 16 marka SSR yang digunakan. Enam marka diantaranya yaitu RM206, RM263, RM276, RM346, RM335 dan RM570 dapat membedakan antar tetua padi hibrida yang diuji. Satu marka RM164 walaupun polimorfis tetapi tidak dapat ..dst",
      "keywords": "hybrid rice seed, hybrid rice seed, SSR, genetic purity, morphologycal characteristic",
      "url": "https://repository.ipb.ac.id/handle/123456789/118600",
      "relevance_score": 0.6072207795582819
    }
  ],
  "ai_response": "Berdasarkan penelitian yang tersedia dalam konteks, berikut adalah penelitian terkait bibit unggul padi di IPB:\n\n1. **Penelitian [4]**: \"Karakter Fisiologi dan Hasil Varietas Padi Tipe Baru IPB\" oleh Raudho, Zahrotur (2025). Penelitian ini membahas pengembangan varietas Padi Tipe Baru yang dikenal dengan “PTB IPB”. Penelitian ini menyoroti keunggulan morfologis dari varietas “PTB IPB” dibandingkan dengan varietas unggul nasional seperti Inpari 30 dan Inpari 32. Beberapa keunggulan morfologis yang ditunjukkan adalah tinggi tanaman yang lebih tinggi, luas daun bendera yang lebih besar, dan jumlah butir per malai yang lebih banyak. Namun, meskipun memiliki keunggulan morfologis, penelitian ini mencatat bahwa peningkatan kinerja fisiologis yang mendukung belum sepenuhnya tercapai, termasuk aspek seperti laju fotosintesis dan efisiensi pengisian biji yang rendah. Faktor lingkungan juga mempengaruhi ekspresi fisiologis varietas ini.\n\n2. **Penelitian [2]**: \"Tingkat Kemasakan Benih Padi Varietas IPB 3S dan Hubungannya dengan Pematahan Dormansi\" oleh Putri, Astari Abyan (2022). Penelitian ini tidak secara langsung membahas bibit unggul tetapi fokus pada metode optimalisasi pematahan dormansi dan kemasakan benih varietas IPB 3S, yang merupakan salah satu varietas yang dikembangkan di IPB.\n\n3. **Penelitian [5]**: \"Identifikasi dan Evaluasi Kemurnian Genetik Benih Padi Hibrida Menggunakan Marka Mikrosatelit\" oleh Mulsanti, Indria Wahyu (2011). Meskipun lebih berfokus pada kemurnian genetik padi hibrida, penelitian ini relevan untuk memahami pentingnya kemurnian genetik dalam pengembangan bibit unggul.\n\nDari penelitian-penelitian di atas, **Penelitian [4]** adalah yang paling relevan terkait bibit unggul padi di IPB. Penelitian ini memberikan pandangan tentang potensi varietas baru yang dikembangkan oleh IPB dan keunggulan morfologis yang ditawarkan. Namun, perlu diperhatikan bahwa penelitian ini juga menekankan pentingnya strategi budidaya yang adaptif untuk memaksimalkan potensi genetik varietas tersebut.",
  "metadata": {
    "query_type": "informational",
    "total_papers_found": 5,
    "search_duration_ms": 1144,
    "rerank_duration_ms": 0,
    "llm_latency_ms": 7064,
    "total_tokens": 3606
  }
}
